
Assume SetÏ‰ in metatheory, use that for cxt interpretation.

type formers
  - âŠ¤, Î , Î£, Uáµ¢ (Coquand style), Bool

  U(i,j) : Ty(i,j+1) Î“
  El     : Tm(i,j) U â†’ Ty(i,j) U
  code   : Ty(i,j) U â†’ Tm(i,j) U   inverses

naming questions:
  - base TT           : ğ•€
  - 2LTT syntax       : just 2LTT
  - eval map          : ğ”¼
  - inner restriction : â„
  - level names: inner, outer
  - use [_] for psh restriction
  - Call SetÌ‚ UÌ‚ instead?

-- Psh model
--------------------------------------------------------------------------------

F (A : Tyâ‚€ Î“)   : SubÌ‚ FÎ“ TyB
F (t : Tmâ‚€ Î“ A) : TmÌ‚ FÎ“ TmB[FA]

F (^(A : Tyâ‚€ Î“)) = TmB[FA]
F <t> = Ft
F ~t  = Ft

F (Î“ â–¶â‚€ A) = Î£ FÎ“ TmB[FA]

...

--------------------------------------------------------------------------------

-- closed staging, yoneda etc

Closed staging

A : Tyâ‚€ âˆ™
|A| tt : TyB âˆ™

t : Tmâ‚€ âˆ™ A
|t| tt : TmB âˆ™ (|A|tt)


Correctness of eval into psh model
--------------------------------------------------------------------------------

- B       : syntax of base theory
- 2LTT    : syntax of 2LTT
- BMod    : model of B
- 2LTTMod : model of 2LTT
- 2LTTáµ’   : models B by forgetting Tyâ‚€ and Tmâ‚€ from 2LTT

- -^  : components of PSh B, e.g. ConÌ‚, TyÌ‚, SetÌ‚ , etc.
- F   : 2LTT â†’ PSh B, evaluation into PSh B model of 2LTT (strict morphism)
- âŒœâŒ  : B â†’ 2LTTáµ’, embedding


-- Stability
--------------------------------------------------------------------------------

(Î“ : ConB)á´¾     : |FâŒœÎ“âŒ|Î“              -- generic environment
(Ïƒ : SubB Î“ Î”)á´¾ : Î”á´¾[Ïƒ] = |FâŒœÏƒâŒ| Î“á´¾
(A : TyB Î“)á´¾    : A = |FâŒœAâŒ| Î“á´¾
(t : TmB Î“ A)á´¾  : t = |FâŒœtâŒ| Î“á´¾

âˆ™á´¾ : |FâŒœâˆ™âŒ|âˆ™
   : âŠ¤
âˆ™á´¾ := tt

(Î“ â–¶ A)á´¾ : |Î£^ FâŒœÎ“âŒ TmB[FâŒœAâŒ]| (Î“ â–¶ A)
         : (Î³ : FâŒœÎ“âŒ(Î“â–¶A)) Ã— TmB (Î“ â–¶ A) (|FâŒœAâŒ| Î³)
(Î“ â–¶ A)á´¾ := (Î“á´¾[p], q)

   q : TmB (Î“ â–¶ A) (|FâŒœAâŒ| (Î“á´¾[p]))
     : TmB (Î“ â–¶ A) ((|FâŒœAâŒ| Î“á´¾)[p])
     : TmB (Î“ â–¶ A) (A[p])

idá´¾ : Î“á´¾[id] = |FâŒœidâŒ| Î“á´¾
    : Î“á´¾ = Î“á´¾ OK

(Ïƒ âˆ˜ Î´)á´¾ : Î£á´¾[Ïƒâˆ˜Î´] = |FâŒœÏƒâˆ˜Î´âŒ| Î“á´¾
         : Î£á´¾[Ïƒ][Î´] = |FâŒœÏƒâŒ| (|FâŒœÎ´âŒ| Î“á´¾)
	 : Î£á´¾[Ïƒ][Î´] = |FâŒœÏƒâŒ| Î”á´¾[Î´]
	 : Î£á´¾[Ïƒ][Î´] = (|FâŒœÏƒâŒ| Î”á´¾)[Î´]
	 : Î£á´¾[Ïƒ][Î´] = Î£á´¾[Ïƒ][Î´] OK

(A[Ïƒ : Sub Î“ Î”])á´¾ : A[Ïƒ] = |FâŒœA[Ïƒ]âŒ| Î“á´¾
                  : A[Ïƒ] = |FâŒœAâŒ[FâŒœÏƒâŒ]| Î“á´¾
		  : A[Ïƒ] = |FâŒœAâŒ| (|FâŒœÏƒâŒ| Î“á´¾)
		  : A[Ïƒ] = |FâŒœAâŒ| (Î”á´¾[Ïƒ])
		  : A[Ïƒ] = (|FâŒœAâŒ| Î”á´¾)[Ïƒ]
		  : A[Ïƒ] = A[Ïƒ] OK

(t[Ïƒ])á´¾ : t[Ïƒ] = |FâŒœt[Ïƒ]âŒ| Î“á´¾
        : t[Ïƒ] = |FâŒœtâŒ| (|FâŒœÏƒâŒ| Î“á´¾)
        : t[Ïƒ] = |FâŒœtâŒ| (Î”á´¾[Ïƒ])
        : t[Ïƒ] = (|FâŒœtâŒ| Î”á´¾)[Ïƒ]
        : t[Ïƒ] = t[Ïƒ] OK

(Ïƒ,t)á´¾ : (Î”â–¶A)á´¾[Ïƒ,t] = |FâŒœÏƒ,tâŒ| Î“á´¾
       : (Î”á´¾[Ïƒ], t)  = |FâŒœÏƒ,tâŒ| Î“á´¾
       : (Î”á´¾[Ïƒ], t)  = (|FâŒœÏƒâŒ|Î“á´¾, |FâŒœtâŒ| Î“á´¾)
       : (Î”á´¾[Ïƒ], t)  = (Î”á´¾[Ïƒ], t)  OK

pá´¾ : Î“á´¾[p] = |FâŒœpâŒ| (Î“â–¶A)á´¾
   : Î“á´¾[p] = |FâŒœpâŒ| (Î“á´¾[p], q)
   : Î“á´¾[p] = Î“á´¾[p] OK

qá´¾ : q = |FâŒœqâŒ| (Î“â–¶A)á´¾
   : q = |FâŒœqâŒ| (Î“á´¾[p], q)
   : q = q OK

âŠ¤á´¾ : âŠ¤ = |FâŒœâŠ¤âŒ| Î“á´¾
   : âŠ¤ = âŠ¤ OK

ttá´¾ trivial

Î á´¾ : Î  A B = |F(âŒœÎ  A BâŒ)| Î“á´¾
   : Î  A B = Î  (|FâŒœAâŒ| Î“á´¾) (|FâŒœBâŒ| (Î“á´¾[p], q))
   : Î  A B = Î  (|FâŒœAâŒ| Î“á´¾) (|FâŒœBâŒ| (Î“â–¶A)á´¾)
   : Î  A B = Î  A B OK

(app t)á´¾ : app t = |FâŒœapp tâŒ| (Î“â–¶A)á´¾
         : app t = |FâŒœapp tâŒ| (Î“á´¾[p], q)
	 : app t = app (|FâŒœtâŒ| Î“á´¾)
	 : app t = app t OK

(lam t)á´¾ : lam t = |FâŒœlam tâŒ| Î“á´¾
         : lam t = lam (|FâŒœtâŒ| (Î“á´¾[p], q))
	 : lam t = lam t OK

Î£á´¾ likewise
Boolá´¾ likewise

-- BoolElim : (B : Ty (Î“ â–¶ Bool))
            â†’ Tm Î“ (B[id,true]) â†’ Tm Î“ (B[id,false]) â†’ (b : Tm Î“ Bool) â†’ Tm Î“ (B[id,b])

(BoolElim B t f b)á´¾ :
  BoolElim B t f b = |FâŒœBoolElim B t f bâŒ| Î“á´¾
  BoolElim B t f b = ...
  OK

(U j)á´¾ : U j = |FâŒœU jâŒ| Î“á´¾
       : U j = U j

(code t)á´¾ : code t = |FâŒœcode tâŒ| Î“á´¾
          : OK

El likewise


-- open staging
--------------------------------------------------------------------------------


Stage : Tyâ‚€ âŒœÎ“âŒ â†’ TyB Î“
Stage A := |F A| Î“á´¾

Stage : Tmâ‚€ âŒœÎ“âŒ âŒœAâŒ â†’ TmB Î“ A
Stage t := |F t| Î“á´¾

Stage' : Tmâ‚€ âŒœÎ“âŒ A â†’ TmB Î“ (Stage A)
Stage' t := |F t| Î“á´¾


-- Soundness
--------------------------------------------------------------------------------

The idea is to have a straightforward logical relation between the staging map F
and a suitably "syntactic" embedding morphism. It's an instance of gluing, but
we don't do gluing because we like to have a clean & self-contained definition
of the staging algorithm, and the gluing presentations either mash it together
with its soundness (HKS gluing), or are way too magical (synthetic computability).

Things in psh model:

  Syntactic base types and terms. Closed under type formers, but we don't use that.

    TyB : SetÌ‚
    |TyB|áµ¢ = TyB i

    TmB : TyB â†’ SetÌ‚
    |TmB|áµ¢ A = TmB i A

  Syntactic inner 2LTT types and terms.

    Tyâ‚€ : SetÌ‚
    |Tyâ‚€|áµ¢ = Tyâ‚€ âŒœiâŒ

    Tmâ‚€ : Tyâ‚€ â†’ SetÌ‚
    |Tmâ‚€|áµ¢ A = Tmâ‚€ âŒœiâŒ A

  *Not* closed under proper type formers, because we can only abstract over
  inner things in pshB.

  Embedding internally:

     âŒœ-âŒ : TyB â†’ Tyâ‚€
     |âŒœâŒ|áµ¢ (A : TyB i) = âŒœAâŒ

     âŒœ-âŒ : TmB A â†’ Tmâ‚€ âŒœAâŒ
     |âŒœâŒ|áµ¢ {A} (t : TmB i A) = âŒœtâŒ

  âŒœâŒ preserves all structure


Syntactic embedding morphism from 2LTT syntax to psh model:

  G is given as (âŒœâŒ* âˆ˜ yoneda) on the outer cwf part ("nerve")

    G (Î“ : Con) : SetÌ‚
    |G Î“|i := Sub âŒœiâŒ Î“

    G (Ïƒ : Sub Î“ Î”) : GÎ“ â†’ GÎ”
    |G Ïƒ|áµ¢ (Î³ : Sub âŒœiâŒ Î“) := Ïƒ âˆ˜ Î³

    G (A : Tyâ‚ Î“) : GÎ“ â†’ SetÌ‚
    |G A|áµ¢ Î³ := Tmâ‚ âŒœiâŒ A[Î³]

    G (t : Tmâ‚ Î“ A) : (Î³ : GÎ“) â†’ GA Î³
    |G t|áµ¢ Î³ := t[Î³]

  On the inner family (preserves all structure)

    G (A : Tyâ‚€ Î“) : GÎ“ â†’ Tyâ‚€
    |G A|áµ¢ Î³ = A[Î³]

    G (t : Tmâ‚€ Î“ A) : (Î³ : GÎ“) â†’ Tmâ‚€ (GA Î³)
    |G t|áµ¢ Î³ = t[Î³]

  G preservation (outer preservation comes from HKS gluing)

    - âˆ™, _â–¶_, Î£, âŠ¤, extensional identity, weak

       G_âˆ™  : G âˆ™         â‰ƒ âŠ¤Ì‚
       G_â–¶â‚ : G (Î“ â–¶â‚ A)  â‰ƒ (Î³ : G Î“) Ã— G A Î³
       G_Î£  : G (Î£ A B) Î³ â‰ƒ (Î± : G A Î³) Ã— G B (Gâ–¶â‚â»Â¹(Î³, Î±))
       G_âŠ¤  : G âŠ¤ Î³       â‰ƒ âŠ¤Ì‚

       Gp (Gâ–¶â‚â»Â¹(Î³, Î±)) = Î³
       Gq (Gâ–¶â‚â»Â¹(Î³, Î±)) = Î±
       G(Ïƒ,t) Î³         = Gâ–¶â‚â»Â¹(GÏƒ Î³, Gt Î³)

    - Î , U lax

      G_app : G (Î  A B) Î³ â†’ ((Î± : G A Î³) â†’ G B (Gâ–¶â»Â¹(Î³, Î±)))
      G_app (G (lam t) Î³) Î± â‰¡ Gt Gâ–¶â»Â¹(Î³, Î±)


      G_code : G U Î³ â†’ SetÌ‚
      G_code (G(El a) Î³) â‰¡ code (Ga Î³) -- more precisely
                         â‰¡ Ga Î³        -- with Russell notation

    - positive inductive types oplax

      G_â„• : â„• â†’ G â„• Î³
      G_âŠ¥ : âŠ¥ â†’ G âŠ¥ Î³

    - Action on Lift:

      (â†“,â†‘) : G (Lift A) Î³ â‰ƒ Tmâ‚€ (G A Î³)
      G (â†‘t) Î³ = â†‘ (Gt Î³)
      G (â†“t) Î³ = â†“ (Gt Î³)

    - Action on â–¶â‚€
       |G(Î“ â–¶â‚€ A)|áµ¢ = Subâ‚ âŒœiâŒ (Î“ â–¶â‚€ A)
                    â‰ƒ (Ïƒ : Subâ‚ âŒœiâŒ Î“) Ã— Tmâ‚€ âŒœiâŒ A[Ïƒ]

       hence:

       Gâ–¶â‚€ : G(Î“ â–¶â‚€ A) â‰ƒ (Î³ : G Î“) Ã— Tmâ‚€ (GA Î³)

       Gpâ‚€    (Gâ–¶â‚€â»Â¹(Î³, Î±)) = Î³
       Gqâ‚€    (Gâ–¶â‚€â»Â¹(Î³, Î±)) = Î±
       G(Ïƒ,t) Î³             = Gâ–¶â‚€â»Â¹(GÏƒ Î³,Gt Î³)


-- The relation
--------------------------------------------------------------------------------

- We work in the internal language of psh(B)
  We convert implicitly to the following style:
  - ConÌ‚     --> SetÌ‚                ("termification")
  - TyÌ‚ Î“    --> (Î“ â†’ SetÌ‚)
  - SubÌ‚ Î“ Î” --> Î“ â†’ Î” â†’ SetÌ‚
  - TmÌ‚ Î“ A  --> (Î³ : Î“) â†’ A Î³
- F goes into the psh model defined as above.
   F (Î“ : Con)     : SetÌ‚
   F (Ïƒ : Sub Î“ Î”) : FÎ“ â†’ FÎ”
   F (A : Tyâ‚ Î“)   : FÎ“ â†’ SetÌ‚
   F (t : Tmâ‚ Î“ A) : (Î³ : FÎ“) â†’ FA Î³
   F (A : Tyâ‚€ Î“)   : FÎ“ â†’ TyB
   F (t : Tmâ‚€ Î“ A) : (Î³ : FÎ“) â†’ TmB (FA Î³)


-- Cat + 2 fam structures
--------------------------------------------------------------------------------

Motives
  (Î“ : Con)á´¿     : FÎ“ â†’ GÎ“ â†’ SetÌ‚
  (Ïƒ : Sub Î“ Î”)á´¿ : Î“á´¿ Î³ Î³' â†’ Î”á´¿ (FÏƒ Î³) (GÏƒ Î³')
  (A : Tyâ‚ Î“)á´¿   : Î“á´¿ Î³ Î³' â†’ FA Î³ â†’ GA Î³' â†’ SetÌ‚
  (t : Tmâ‚ Î“ A)á´¿ : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ Aá´¿ Î³á´¿ (Ft Î³) (Gt Î³')
  (A : Tyâ‚€ Î“)á´¿   : Î“á´¿ Î³ Î³' â†’ âŒœFA Î³âŒ = GA Î³'                   -- Tyâ‚€ equations by UIP
  (t : Tmâ‚€ Î“ A)á´¿ : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ âŒœFt Î³âŒ = Gt Î³'            -- Tmâ‚€ equations by UIP

Category
  idá´¿ Î³á´¿          := Î³á´¿
  (Ïƒ âˆ˜ Î´)á´¿ Î³á´¿     := Ïƒá´¿ (Î´á´¿ Î³á´¿)
  âˆ™á´¿ _ _          := âŠ¤^

Outer family
  (Î“ â–¶â‚ A)á´¿ (Î³, Î±) (Gâ–¶â‚â»Â¹(Î³', Î±')) := (Î³á´¿ : Î“á´¿ Î³ Î³') Ã— Aá´¿ Î³á´¿ Î± Î±'
  (A[Ïƒ])á´¿ Î³á´¿ Î± Î±' := Aá´¿ (Ïƒá´¿ Î³á´¿) Î± Î±'
  (t[Ïƒ])á´¿ Î³á´¿      := tá´¿ (Ïƒá´¿ Î³á´¿)
  (Ïƒ, t)á´¿ Î³á´¿      := (Ïƒá´¿ Î³á´¿, tá´¿ Î³á´¿)
  pá´¿ (Î³á´¿, tá´¿)     := Î³á´¿
  qá´¿ (Î³á´¿, tá´¿)     := tá´¿


Inner family
  (Î“ â–¶â‚€ A)á´¿ (Î³, Î±) (Gâ–¶â‚€â»Â¹(Î³', Î±')) := (Î³á´¿ : Î“á´¿ Î³ Î³') Ã— (âŒœÎ±âŒ = Î±')

     A   : Tyâ‚€ Î“
     Î±   : TmB (FA Î³)
     âŒœÎ±âŒ : Tmâ‚€ âŒœFA Î³âŒ
         : Tmâ‚€ (GA Î³')
     Î±'  : Tmâ‚€ (GA Î³')

  (A[Ïƒ])á´¿ Î³á´¿ : âŒœF(A[Ïƒ]) Î³âŒ = G(A[Ïƒ]) Î³'
             : âŒœFA (FÏƒ Î³)âŒ = GA (GÏƒ Î³')
    by Aá´¿ (Ïƒá´¿ Î³á´¿)

  (t[Ïƒ])á´¿ Î³á´¿ : âŒœFt (FÏƒ Î³)âŒ = Gt (GÏƒ Î³')
    by tá´¿ (Ïƒá´¿ Î³á´¿)

  (Ïƒ,t)á´¿ Î³á´¿ : (Î” â–¶â‚€ A)á´¿ (F(Ïƒ,t) Î³)   (G(Ïƒ,t) Î³')
            : (Î” â–¶â‚€ A)á´¿ (FÏƒ Î³, Ft Î³) (Gâ–¶â‚€â»Â¹(GÏƒ Î³', Gt Î³'))
	    : (Î´á´¿ : Î”á´¿ (FÏƒ Î³) (GÏƒ Î³')) Ã— âŒœFt Î³âŒ = Gt Î³'
	    := (Ïƒá´¿ Î³á´¿, tá´¿ Î³á´¿)

   pâ‚€á´¿ (Î³á´¿, Î±á´¿) := Î³á´¿
   qâ‚€á´¿ (Î³á´¿, Î±á´¿) := Î±á´¿


-- Lifting structure
--------------------------------------------------------------------------------

(Lift A)á´¿ : Î“á´¿ Î³ Î³' â†’ F (Lift A) Î³ â†’ G(Lift A) Î³' â†’ SetÌ‚
          : Î“á´¿ Î³ Î³' â†’ TmB (FA Î³) â†’ G (Lift A) Î³' â†’ SetÌ‚
          := Î» Î³á´¿ t t'. âŒœtâŒ = â†“t'

(â†‘t)á´¿ : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ (Lift A)á´¿ Î³á´¿ (F(â†‘t) Î³) (G(â†‘t) Î³')
      : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ âŒœF(â†‘t) Î³âŒ = â†“ (G(â†‘t) Î³')
      : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ âŒœFt Î³âŒ = Gt Î³'
  by tá´¿ Î³á´¿

(â†“t)á´¿ : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ âŒœF(â†“t) Î³âŒ = G(â†“t) Î³'
      : (Î³á´¿ : Î“á´¿ Î³ Î³') â†’ âŒœFt Î³âŒ = â†“(Gt Î³')

  by tá´¿ Î³á´¿

-- Outer types
--------------------------------------------------------------------------------

âŠ¥á´¿ Î³á´¿ : FâŠ¥ Î³ â†’ GâŠ¥ Î³' â†’ SetÌ‚
      : âŠ¥Ì‚  â†’ GâŠ¥ Î³' â†’ SetÌ‚
  vacuous

âŠ¤á´¿ Î³á´¿ : âŠ¤^ â†’ GâŠ¤ Î³' â†’ SetÌ‚
 âŠ¤á´¿ Î³á´¿ t t' := âŠ¤^

ttá´¿ Î³á´¿ := tt

(Î£ A B)á´¿ Î³á´¿ : ((Î± : FA Î³) Ã— FB (Î³, Î±)) â†’ G(Î£ A B) Î³' â†’ SetÌ‚
  (Î£ A B)á´¿ Î³á´¿ (Î±, Î²) (GÎ£â»Â¹(Î±', Î²')) := (Î±á´¿ : Aá´¿ Î³á´¿ Î± Î±') Ã— Bá´¿ (Î³á´¿, Î±á´¿) Î² Î²'

  -- pairing & proj obvious

(Î  A B)á´¿ Î³á´¿ : ((Î± : FA Î³) â†’ FB (Î³, Î±)) â†’ G(Î  A B) Î³' â†’ SetÌ‚
  (Î  A B)á´¿ Î³á´¿ t t' :=
    (Î± : FA Î³)(Î±' : GA Î³')(Î±á´¿ : Aá´¿ Î³á´¿ Î± Î±') â†’ Bá´¿ (Î³á´¿, Î±á´¿) (t Î±) (G_app t' Î±')

(lam t)á´¿ Î³á´¿ : (Î  A B)á´¿ Î³á´¿ (F(lam t) Î³) (G(lam t) Î³')
            : âˆ€ Î± Î±' (Î±á´¿ : Aá´¿ Î³á´¿ Î± Î±') â†’ Bá´¿ (Î³á´¿, Î±á´¿) (Ft (Î³, Î±)) (G_app (G(lam t) Î³') Î±')
	    : âˆ€ Î± Î±' (Î±á´¿ : Aá´¿ Î³á´¿ Î± Î±') â†’ Bá´¿ (Î³á´¿, Î±á´¿) (Ft (Î³, Î±)) (Gt Gâ–¶â‚â»Â¹(Î³', Î±'))
	    := Î» Î± Î±' Î±á´¿. tá´¿ (Î³á´¿, Î±á´¿) (Ft (Î³, Î±)) (Gt Gâ–¶â‚â»Â¹(Î³', Î±))


â„•á´¿ Î³á´¿ : â„•^ â†’ G â„• Î³' â†’ SetÌ‚
  â„•á´¿ Î³á´¿ t t' := (G_â„• t = t')

zeroá´¿ Î³á´¿ : G_â„• zeroÌ‚ =


-- Inner types
--------------------------------------------------------------------------------

Boolâ‚€á´¿ : Î“á´¿ Î³ Î³' â†’ âŒœF Boolâ‚€ Î³ âŒ = G Boolâ‚€ Î³'
       : Î“á´¿ Î³ Î³' â†’ Boolâ‚€ = Boolâ‚€ OK

trueâ‚€á´¿ Î³á´¿ : âŒœF trueâ‚€ Î³âŒ = G trueâ‚€ Î³'
          : trueâ‚€ = trueâ‚€ OK

falseâ‚€á´¿ Î³á´¿ ...

BoolElimâ‚€á´¿ Î³á´¿ : âŒœF (BoolElimâ‚€ B t f b) Î³âŒ = G (BoolElimâ‚€ B t f b) Î³'
       BoolElimâ‚€ (âŒœF BâŒ Î³) (âŒœF tâŒ Î³) (âŒœF fâŒ Î³) (âŒœF bâŒ Î³)
     = BoolElimâ‚€ (G B Î³') ....
     OK

etc...


-- General soundness
--------------------------------------------------------------------------------

-- externalizing á´¿:

  for (Î“ : Con)
    |Î“á´¿| : |F Î“|i â†’ Sub âŒœiâŒ Î“ â†’ Set

  for (A : Tyâ‚€ Î“)
    |Aá´¿| : |Î“á´¿| Î³ Î³' â†’ âŒœFA Î³âŒ = A[Î³']

  for (t : Tmâ‚€ Î“ A)
    |tá´¿| : (Î³á´¿ : |Î“á´¿| Î³ Î³') â†’ âŒœFt Î³âŒ = t[Î³']

-- soundness of generic contexts

(Î“ : ConB)á´¾á´¿ : |Î“á´¿| Î“á´¾ (id : Sub âŒœÎ“âŒ âŒœÎ“âŒ)

âˆ™á´¾á´¿ : âŠ¤
    := tt

(Î“ â–¶ A)á´¾á´¿ : |(Î“â–¶A)á´¿| (Î“â–¶A)á´¾     id
          : |(Î“â–¶A)á´¿| (Î“á´¾[p], q) (p, q)
	  : (Î³á´¿ : |Î“|á´¿ (Î“á´¾[p]) p) Ã— (âŒœqâŒ = q)

  Î“á´¾á´¿ : |Î“á´¿| Î“á´¾ id   -- by stability of Î“á´¿

  Î“á´¾á´¿[p] : |Î“|á´¿ Î“á´¾[p] idâˆ˜p
         : OK


--
--------------------------------------------------------------------------------


to show:

  âŒœStage AâŒ  = A
  âŒœ|F A| Î“á´¾âŒ = A

    |Aá´¿| Î“á´¾á´¿ : âŒœ|F A| Î“á´¾âŒ = A[id] = A OK

  âŒœStage tâŒ = t
  âŒœ|F t| Î“á´¾âŒ = t

    |tá´¿| Î“á´¾á´¿ :  âŒœ|F t| Î“á´¾âŒ = t[id] = t OK

thus
  TyB Î“ â‰ƒ Tyâ‚€ âŒœÎ“âŒ
  TmB Î“ A â‰ƒ Tmâ‚€ âŒœÎ“âŒ âŒœAâŒ
